"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decryptUint8Array = exports.encryptUint8Array = void 0;
const themis_secure_cell_seal_1 = require("./themis-secure-cell-seal");
const data_sizes_1 = require("./data-sizes");
const decryption_error_1 = require("./decryption-error");
async function encryptUint8Array(data, password) {
    data_sizes_1.assertDataSizeOk(data);
    data_sizes_1.assertPasswordSizeOk(password);
    const cell = await themis_secure_cell_seal_1.getThemisSecureCellSeal(password);
    return cell.encrypt(data);
}
exports.encryptUint8Array = encryptUint8Array;
async function decryptUint8Array(data, password) {
    data_sizes_1.assertDataSizeOk(data);
    data_sizes_1.assertPasswordSizeOk(password);
    try {
        const cell = await themis_secure_cell_seal_1.getThemisSecureCellSeal(password);
        return cell.decrypt(data);
    }
    catch (_a) {
        throw new decryption_error_1.DecryptionError('Unable to decrypt - password is incorrect or data is corrupted.');
    }
}
exports.decryptUint8Array = decryptUint8Array;
